"Amazon Web Services® (AWS®) Audit Program
Security Logging and Monitoring",,,,,,,,,,,
"Process
Sub-area",Ref. Risk,Control Objectives,Controls,Control Type,Control Classification,Control Frequency,Testing Step,Ref. Framework/ Standards,Ref. Workpaper,"Pass/
Fail",Comments
"Defining Monitoring Requirements
by AWS Application",,"Through its formal security monitoring program, the enterprise mitigates the risk that access to its data and systems is denied due to malicious acts.","The enterprise completely and accurately defines minimum monitoring requirements for AWS applications and related resources. AWS Monitoring requirements are formally documented and reviewed on a frequency predetermined by the enterprise.

Note: Monitoring may include certain types of events, processes or API calls, or extend to higher-level attributes, such as source of event, account-making changes, date/time, etc.",,,,"1. Interview responsible and/or accountable individuals (security, operations management, etc.) to determine whether AWS applications in use and related resources have a minimum set of monitoring and logging requirements. Confirm that the monitoring and logging requirements are both formally documented and reassessed routinely for completeness and accuracy.
2. Inquire about:
 • In-scope AWS applications and related resources
 • Individuals responsible and methods used to identify new applications on which monitoring should be enabled
 • Any standards or frameworks used by the enterprise to derive monitoring baselines
 • Frequency of review against established monitoring requirements
2. Obtain documentation of the population of in-scope AWS applications and related resources. Through judgmental sampling, obtain and inspect enterprise documentation that details monitoring requirements for each in-scope AWS application and related resources.",,,,
Configured Logging Requirements,,,The enterprise programmatically enforces minimum monitoring requirements through application configuration. AWS applications are configured to generate and retain monitored events required by the enterprise.,,,,"1. Interview responsible and/or accountable individuals (security, operations management, etc.) to determine how the enterprise's monitoring standards are enforced on an application-by-application basis. 
2. Determine:
• How the enterprise detects lack of compliance with monitoring standards
• Timeliness of remediation upon discovery of noncompliance
3. Using the defined requirements gathered in the previous step, select a judgmental sample of AWS applications and determine whether the documented monitoring standards are enforced in each application.",,,,
Log Storage,,The enterprise ensures that its log-retention practices meet compliance requirements as well as business needs.,"The enterprise retains logs generated by AWS applications in a secure, centralized location, using AWS Simple Storage Service (S3) buckets and AWS Glacier.",,,,"1. Interview responsible and/or accountable individuals to determine how log aggregation, retention and access security are managed, giving specific attention to the application destinations for generated monitoring logs.
2. Inquire whether:
 • Classification is performed on logs stored in each log-storage solution
 • Data-retention policies are enforced by classification in each log-storage solution
 • Short-term logging requirements (S3) and long-term storage requirements (Glacier) are identified and configured
 • Access is routinely reviewed for appropriateness for each log-storage solution
3. Using previously obtained documentation, obtain and inspect individual AWS application configurations to determine whether in-scope applications are configured to send logs to the appropriate log-storage solution.
4. Inspect data-retention settings to determine whether complete and accurate data transfer between short- to long-term storage is performed.
",,,,
Restricting Log Access,,The enterprise maintains log integrity by limiting access to individuals with a valid business need.,"Access to AWS logs is based on job responsibilities and least privilege, and is reviewed by management on a periodic basis.",,,,"1. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine how access to logs generated by AWS applications and related resources is controlled, and identify the users or departments that should have access, based on job responsibilities.
2. Inquire about reviews of access for appropriateness and methods used to identify and remove inappropriate access.
3. Obtain and inspect access lists and inquire with management to determine appropriateness of access.
4. Obtain and inspect completed access reviews to determine that inappropriate access (once identified) is removed in a timely manner.
",,,,
Monitoring Log Status,,The enterprise maintains log integrity through monitoring and investigating attempts to modify log data.,"CloudWatch alarms are configured to notify appropriate groups or individual(s)  when successful or failed attempts to alter log data occur.

Note: Malicious users may attempt to cover their tracks during or after an attack by altering the bucket policy, deleting logs, overwriting logs, modifying alarm recipients, or changing alarm status (on/off) or other log settings.",,,,"1. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine whether the enterprise has mechanisms in place that notify personnel and trigger timely investigations if alarms are triggered by attempts to modify logs or related security settings.
2. Inquire whether multifactor authentication DELETE requirements are in place for in-scope S3 buckets (attempts to delete S3 buckets would require users to multifactor authenticate first).
3. Observe whether live attempts to alter log data generate timely alerts to the responsible departments or individuals.
4. Obtain and inspect alarm configuration, noting:
• Events and thresholds triggering the alarm (success and failure)
• Recipients of the alarm are the intended departments or individuals
",,,,
"Setting
Log Retention",,The enterprise ensures that its log retention practices meet compliance requirements as well as business needs.,"The enterprise establishes minimum requirements for retaining log data, based upon defined requirements. Periodic reviews confirm alignment of current practices with the enterprise's defined log data retention requirements.

Note: Required retention periods may be based upon regulations and/or determined on an application-by-application basis, depending on number of logging repositories used. Logs should be retained for a period that will allow logs to be useful in the event of security breaches or fraud investigations. ",,,,"1. Determine whether logs are retained in accordance with enterprise requirements by reviewing life cycle configuration policies for logging repositories.
2. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine whether requirements exist that specify period of log retention prior to logs being purged from the environment.

",,,,
"Reviewing Logs
for Events
of Interest",,The enterprise routinely improves security posture and logging capabilities through formalized reviews.,"The group or individual(s), identified by the enterprise, review logs on a periodic basis for suspicious events or anomalies.

Note: Active or past security breaches may be detected through a manual or semimanual log-review process. These reviews may further identify security control weaknesses that the enterprise should mitigate for enhanced protection. ",,,,"1. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine whether procedures are in place (or automated mechanisms exist) to review logs generated by AWS applications. 
2. Determine how identified anomalies or suspicious events are investigated, documented, communicated and remediated within the enterprise.
3. Obtain and inspect completed log reviews evidencing that they occur as required by the enterprise.
4. Document population of identified suspicious events and/or anomalies. Through judgmental sampling, determine whether identified suspicious events and/or anomalies have been properly investigated, documented, communicated and remediated, as necessary.",,,,
"Managing
Logging Failure",,The enterprise identifies and addresses logging failure events in a timely manner.,"CloudWatch alarms are configured to notify the appropriate group or individual(s)  when logging functionality is compromised.

Note: Logging failure covers a variety of events from running out of available disk space to intentional or accidental disabling/modification of configurations.  These scenarios and others should be investigated.",,,,"1. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine the mechanism used by the enterprise to detect logging failures and the individuals who are informed of logging failures.
2. Observe generation and receipt of messages for instances where logging is disabled (or configuration modifications have disabled logging).
3. Obtain and inspect event monitoring and alarm configurations to determine whether alarms will be sent to appropriate personnel following logging failures.
",,,,
Accurate Log Timestamps,,The enterprise maintains log integrity by using an authoritative and synchronized time source.,"The enterprise configures EC2 instances to synchronize time with AWS Network Time Protocol (NTP) servers.

Note: A majority of AWS services, like S3, Redshift, Lambda, etc., sync time with NTP servers in Amazon data centers, for which AWS will likely not provide configuration evidence. In this case, in order to gain assurance on synchronized time, the assessor may wish to leverage AWS Artifact to obtain and review SOC reports issued by AWS for those regions (and/or availability zones).",,,,"1. Interview responsible and/or accountable personnel to determine how unified timestamping is achieved for EC2 server instances deployed in the enterprise, and how often authoritative NTP server polling occurs.
2. Document the population of EC2 instances that exist in every VPC, per region.
For Windows® Servers in each VPC:
a) Open the Command prompt.
b) Type ""w32tm /query /configuration"" (Amazon's time server ""169.254.169.123"" should be listed as the ""NtpServer"" value)
c) Type ""w32tm /query /status"" to determine the polling interval for each EC2 instance.
For Linux® Servers in each VPC:
a) Obtain and inspect the chrony.conf file from the following directory (/ etc./chrony.conf ), and determine if AWS time server is present in the file.
- issue"" $ chronyc sources -v "" command
b) Obtain and inspect screenshots that the chrony service is running on the instance and is set to run at instance startup
- issue "" $ sudo chkconfig chronyd on "" command",,,,
"Assessing Adequate
Logging Coverage",,The enterprise routinely assesses completeness and accuracy of logging as the enterprise expands or contracts its IT footprint.,"On a periodic basis, the enterprise reviews logging and monitoring capabilities to determine if additional logging is required or if monitoring should be disabled.

Note: In AWS, there is typically a cost associated with configuring monitoring and logging solutions that the enterprise uses for its services. The enterprise should consider its monitoring needs as it onboards additional applications or resources into AWS, and as it retires them. These exercises aim to reduce white noise and manage costs.",,,,"1. Interview responsible and/or accountable individuals to determine the approaches that the enterprise takes to rightsize its logging and monitoring capabilities. 
2. Inquire about:
 • The frequency of monitoring reviews
 • Documentation and communication of monitoring reviews
 • How decisions are made to add or remove monitoring and by whom
 • Timeliness of making adjustments (monitoring additions or removals)
2. Obtain and inspect completed monitoring reviews to determine whether they are occurring as required by the enterprise.
3. Obtain documentation of the population of monitoring changes in the period under review. Through judgmental sampling, obtain and inspect documented changes, to determine whether proper authorization of monitoring changes has been provided prior to executing the changes.",,,,
"Detecting Attempted
Privilege Abuse",,The enterprise maintains integrity over privileged network accounts by monitoring AWS account or access-rights abuse and responding in a timely manner.,CloudWatch alarms are configured to detect and inform the appropriate group or individual(s) when authentication failures occur for sensitive accounts.,,,,"1. Interview responsible and/or accountable individuals (security, infrastructure, etc.) to determine whether the enterprise has developed and deployed mechanisms that detect attempts to authenticate to privileged network accounts.
2. Inquire into the history of these types of events. Identify recipients of alerts and timeliness of responses to events. Events may include, but are not limited to:
 • Attempts to add inappropriate users to access roles or groups not part of their job responsibilities
 • Removal of appropriate users from access roles or security groups
 • Repeated failures to authenticate to an account over short and long periods of time
 • Modifying the list of APIs that a given access role or group possesses
3. Obtain and inspect alarm configuration for each scenario to determine whether triggers, receipt of alarms, and follow-up investigations occurred as required by the enterprise.",,,,
,,,,,,,,,,,